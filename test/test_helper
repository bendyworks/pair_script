it() {
  description="$1"
}

assert() {
  if [[ $# -lt 2 ]]; then
    echo "Usage: $0 OPERAND [ARGS...]"
  fi

  case "x$1" in

  x== | xequal )
    print_result "[[ ! '$2' = '$3' ]]" "expected [$2] to equal [$3]"
  ;;

  x=~ | xmatch )
    print_result "[[ ! '$2' =~ $3 ]]" "expected [$2] to match [$3]"
  ;;

  xblank )
    print_result "[[ -n '$2' ]]" "expected [$2] to be blank"
  ;;

  *) echo "Unknown operand [$1]"; exit 1

  esac
}

print_result() {
  local red="\033[0;31m"
  local green="\033[0;32m"
  local norm="\033[0m"

  if eval $1; then
    echo -e "\n$red$description\n$2$norm" >&2
    fail=true
  else
    echo -ne $green.$norm
  fi
}
